-----
#P3.1
---
(a) State Variable
$$x_{1}(t) = y(t)$$
$$x_{2}(t) = \dot{y}(t)$$  라 하자

$$\ddot{y}(t) = \frac{\text{d}x_{2}}{\text{d}t}(t)$$


(b) Differential Equation
$$M\ddot{y}(t)=-ky(t)-b\dot{y}(t)+F(t) $$  

$$\frac{d x_1(t)}{dt} = x_2(t)$$

$$M \frac{d x_2(t)}{dt} = F(t) - k x_1(t) - b x_2(t)$$

$$\frac{d x_2(t)}{dt} = \frac{1}{M} F(t) - \frac{k}{M} x_1(t) - \frac{b}{M} x_2(t)$$

$$y(t) = x_1(t) \quad \text{(출력)}$$


(c) State Space

$$\dot{x}(t) =
\begin{bmatrix}
0 & 1 \\
-\frac{k}{M} & -\frac{b}{M}
\end{bmatrix} x(t) +
\begin{bmatrix}
0 \\
\frac{1}{M}
\end{bmatrix} F(t)$$

$$y(t) =
\begin{bmatrix}
1 & 0
\end{bmatrix} x(t)$$

---
#P3.3
---
Apply KCL  

$$ i_{L}(t) = \frac{v_{2}(t)-v_{c}(t)}{R} - C\frac{dv_{c}(t)}{dt} $$

$$ x_{1}(t) =i_{L}(t)  $$ 
$$ x_{2}(t) = v_{c}(t) $$

$$\frac{dx_{2}(t)}{dt} = -\frac{1}{C}x_{1}(t) - \frac{x_{2}(t)}{RC} + \frac{v_{2}(t)}{RC}$$

Apply KVL

$$-v_{1}(t) + L\frac{di_{L}(t)}{dt} - v_{c}(t) + v_{2}(t) = 0$$

$$ x_{1}(t) =i_{L}(t)  $$ 
$$ x_{2}(t) = v_{c}(t) $$

$$L\frac{dx_{1}(t)}{dt} = v_{1}(t) - v_{2}(t) + x_{2}(t) $$

$$\frac{dx_{1}(t)}{dt} = \frac{x_{2}(t)}{L} + \frac{v_{1}(t)}{L} - \frac{v_{2}(t)}{L}  $$


$$\frac{dx_{2}(t)}{dt} = -\frac{1}{C}x_{1}(t) - \frac{x_{2}(t)}{RC} + \frac{v_{2}(t)}{RC}$$


$$\dot{x}(t) = \begin{vmatrix} 0 && \frac{1}{L} \\
-\frac{1}{C} && -\frac{1}{RC} \end{vmatrix}x(t) + \begin{vmatrix} \frac{1}{L} && -\frac{1}{L} \\
0 && \frac{1}{RC} \end{vmatrix}v(t)$$


---
#P3.5
---
$$Y(s) = (s+2) z(s)$$

$$R(s) = (s^3 + 5s^2 - 23s + 2) z(s)$$

$$Y(t) = \dot{z}(t) + 2z(t)$$

$$R(t) = \dddot{z}(t) + 5\ddot{z}(t) - 23\dot{z}(t) + 2z(t)$$

$$
\begin{bmatrix}
x_1(t) \\
x_2(t) \\
x_3(t)
\end{bmatrix} =
\begin{bmatrix}
z(t) \\
\dot{x_1}(t) \\
\dot{x_2}(t)
\end{bmatrix} =
\begin{bmatrix}
z(t) \\
\dot{z}(t) \\
\ddot{z}(t)
\end{bmatrix}
$$

$$\dot{x_3}(t) = \dddot{z}(t) = u(t) - 5\ddot{z}(t) + 23\dot{z}(t) - 2z(t) = u(t) - 5x_3(t) + 23x_2(t) - 2x_1(t)$$

$$y(t) = x_2(t) + 2x_1(t)$$

$$\dot{x}(t)=\begin{bmatrix}0 && 1 && 0  \\
0 && 0 && 1\\
-2 && 23 && -5\end{bmatrix}x(t)+\begin{bmatrix}0 \\
0\\
1 \end{bmatrix}u(t)$$
$$y(t)=\begin{bmatrix}2 & 1 &0 \end{bmatrix}x(t)$$

--------
#P3.12
---
(a)
$$Y(s)=(8s+40)z(s)$$
$$U(s) = (s^3 + 12s^2 + 44s + 48) \cdot z(t)$$

역라플라스 :  

$$
y(t) = 8\dot{z}(s) + 40z(s)
$$

$$
u(t) = \dddot{z}(s) + 12\ddot{z}(s) + 44\dot{z}(s) + 48z(s)
$$

$$
\begin{bmatrix}
x_1(t) \\
x_2(t) \\
x_3(t)
\end{bmatrix} =
\begin{bmatrix}
z(t) \\
\dot{x_1}(t) \\
\dot{x_2}(t)
\end{bmatrix} =
\begin{bmatrix}
z(s) \\
\dot{z}(s) \\
\ddot{z}(s)
\end{bmatrix}
$$

$$
\dot{x_3}(t) = \dddot{z}(t) = u(t) - 12\ddot{z}(s) - 44\dot{z}(s) - 48z(s) = u(t) - 12x_3(t) - 44z_2(t) - 48x_1(t)
$$

$$
y(t) = 8x_2(t) + 40x_1(t)
$$  

State Variable Model :  

$$
\dot{x}(t) = \begin{bmatrix}0 && 1 && 0 \\
0 && 0 && 1 \\
-48 && -44 && -12\end{bmatrix} x(t) + \begin{bmatrix}0 \\
0 \\
1\end{bmatrix} r(t)
$$

$$
y(t) = \begin{bmatrix}40 & 8 & 0\end{bmatrix} x(t)
$$

(b) State Transition Matrix

$$
\Phi(s) = (sI - A)^{-1}
$$

$$
A = \begin{bmatrix} 0 && 1 && 0 \\
0 && 0 && 1 \\
-48 && -44 && -12 \end{bmatrix}
$$

검산 By MATLAB :  


```
syms s
num = [0 0 8 40];
den = [1 12 44 48];

[A, B, C, D] = tf2ss(num,den)
```

---------------
#P3.17
---
$$G(s) = \frac{Y(s)}{U(s)} = C \cdot \Phi(s) \cdot B + D$$
$$\Phi(s) = (sI - A)^{-1}$$

By MATLAB :  


```
syms s
A = [1 1 -1; 4 3 0; -2 1 10];
B = [0; 0; 4];
C = [1 0 0];
D = 0;

Phi = inv(s*eye(3)-A);
G = C * Phi * B + D;
pretty(G)
```
